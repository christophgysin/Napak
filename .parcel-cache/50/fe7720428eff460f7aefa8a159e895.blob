let e=e=>{let{dateString:t,dateFormat:s="yyyy-mm-dd"}=e;if(!t)return;let l=new Date(t),o={yyyy:l.getFullYear(),mm:String(l.getMonth()).padStart(2,0),dd:String(l.getDate()).padStart(2,0),HH:String(l.getHours()).padStart(2,0),MM:String(l.getMinutes()).padStart(2,0),SS:String(l.getSeconds()).padStart(2,0),MS:String(l.getMilliseconds()).padStart(3,0)};return Object.entries(o).forEach(([e,t])=>{let l=new RegExp(e,"gm");s=s.replace(l,t)}),s};window;const t=function(e){localStorage.setObject(e.key,e.keydata)},s=function(e){return!!localStorage.getObject(e.key)&&localStorage.getObject(e.key)};Storage.prototype.setObject=function(e,t,s){try{this.removeItem(e),this.setItem(e,JSON.stringify(t))}catch(e){console.log(e)}},Storage.prototype.getObject=function(e,t){return JSON.parse(this.getItem(e))};const l={get:(e,t)=>e[t],set:(e,t,s)=>{e[t]=s,console.log("setting property ".concat(t," : ").concat(e[t]));for(let s=0,l=a.storeObservers.length;s<l;s++)a[a.storeObservers[s].key]===e[t]&&a.storeObservers[s].callback();return!0}};let o={},n=e({dateString:(new Date).getTime()});["boulder","sport","trad","toprope"].forEach(e=>{o[e]={},o[e][n]={indoors:{},outdoors:{}}});let r=s({key:"user"}).ticks;const a=new Proxy({pushHistory:{},routes:{},storeObservers:[],openMenus:[],today:n,grades:{font:["3","4","4+","5","5+","6A","6A+","6B","6B+","6C","6C+","7A","7A+","7B","7B+","7C","7C+","8A","8A+","8B","8B+","8C","8C+","9A"]},currentAscentType:"",currentAscentGrade:0,indoorsOutdoors:"indoors",currentClimbingType:"boulder",scope:"today",currentScore:[0,0,0,0,0],totalScore:0,averageGrade:"N/A",totalAscentCount:[{today:0,alltime:0,thirtydays:0,year:0}],totalAscents:{redpoint:0,flash:0,onsight:0},totalAscentsByType:{boulder:0,toprope:0,sport:0,trad:0},ticks:r||[]},l);function c(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,l)}return s}function i(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?c(Object(s),!0).forEach((function(t){d(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):c(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function d(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}let p=e=>{let t=document.createElement(e.el);if(e.cssClass&&(t.className=e.cssClass),e.source&&t.setAttribute("src",e.source),e.cssStyle&&t.setAttribute("style",e.cssStyle),e.id&&t.setAttribute("id",e.id),e.content&&t.appendChild(document.createTextNode(e.content)),e.attrbs)for(let s=0,l=e.attrbs.length;s<l;s++)t.setAttribute(e.attrbs[s][0],e.attrbs[s][1]);return t},u=()=>h().reduce((e,t)=>Number(e)+Number(t),0),g=e=>{let t=f({scope:a.scope}),s=[];if(t.forEach(e=>{s.push(e.grade)}),s.length<1)return"N/A";s=s.sort((function(e,t){return t-e})).slice(0,5),s=s.reduce((e,t)=>Number(e)+Number(t),0);let l=s/e;return a.grades.font[Math.round(l)]},h=()=>{let e=f({scope:a.scope}),t=[0,0,0,0,0];return e.forEach(e=>{t.push(y({type:e.ascentType,grade:e.grade,sport:e.type}))}),t.sort((function(e,t){return t-e})).slice(0,5)},y=e=>{let t=0,s=0,l=0;"flash"===e.type&&(s=1,l=3),"onsight"===e.type&&(s="boulder"===e.sport?2:3,l=-5),"toprope"===e.sport&&(s-=1);let o=Number(e.grade)+s;return t=50*(o+(o>=5?3:1))+l,t},b=e=>{let t={redpoint:0,onsight:0,flash:0,total:0},s=f({scope:e});return["redpoint","onsight","flash"].forEach(e=>{let l=s.filter(t=>t.ascentType===e&&t.type===a.currentClimbingType&&t.indoorsOutdoors===a.indoorsOutdoors);t[e]=l.length,t.total+=l.length}),t},C=()=>{let e={};for(let t=0,s=a.grades.font.length;t<s;t++)e[t]=0;let t={redpoint:i({},e),flash:i({},e),onsight:i({},e)};return f({scope:"today"}).forEach(e=>{e.indoorsOutdoors===a.indoorsOutdoors&&e.type===a.currentClimbingType&&(t[e.ascentType][e.grade]||(t[e.ascentType][e.grade]=0),t[e.ascentType][e.grade]+=1)}),t},m=()=>{let e={boulder:0,sport:0,toprope:0,trad:0},t=f({scope:"today",allTypes:!0});return Object.keys(e).forEach(s=>{let l=t.filter(e=>e.type===s&&e.indoorsOutdoors===a.indoorsOutdoors);e[s]=l.length}),e},v=e=>{let t=f({scope:e.scope}),s=new Array(a.grades.font.length).fill(0),l=a.currentClimbingType;return s.forEach((o,n)=>{let r=t.filter(t=>t.type===l&&t.indoorsOutdoors===(e.indoorsOutdoors?e.indoorsOutdoors:a.indoorsOutdoors)&&t.grade===n);s[n]=r.length}),s},f=e=>{let t,s=a.today.split("-"),l=Number(s[0]),o=Number(s[1]),n=Number(s[2]);"thirtydays"===e.scope&&(o-=1),"year"===e.scope&&(l-=1),"alltime"===e.scope&&(l=2e3,o=1,n=1),t=new Date(Number(l),Number(o),Number(n)).getTime();let r=[];return console.log(t),a.ticks.forEach(s=>{s.date>=t&&(s.type===a.currentClimbingType||e.allTypes)&&r.push(s)}),r};class O{constructor(e){this.selected=!1,this.targetObj=e.targetObj;let t=p({el:"UL",cssClass:e.cssClass,id:e.id});for(let s=0,l=e.options.length;s<l;s++){let l=p({el:"LI"});e.options[s].selected&&(l.classList.add("selected"),this.selected=e.options[s],a[e.targetObj]=e.options[s].value);let o=p({el:"A"});o.value=e.options[s].value;let n=p({el:"SPAN",cssClass:"menu-title",content:e.options[s].title}),r=e.options[s];o.addEventListener("click",()=>{this.set(o,r)},!1),o.appendChild(n);let c=p({el:"SPAN",cssClass:"legends-holder"}),i=p({el:"SPAN",cssClass:"legend type-".concat(e.options[s].value),content:e.options[s].legend?e.options[s].legend:""});i.value=e.options[s].val,c.appendChild(i),o.appendChild(c);let d=()=>{let e=i.value;if(e){let t=e.split(".").reduce((e,t)=>e[t],a);i.innerHTML=t||""}};a.storeObservers.push({key:"indoorsOutdoors",callback:d}),a.storeObservers.push({key:"ticks",callback:d}),l.appendChild(o),t.appendChild(l)}this.render=()=>t,this.set=(t,s)=>{a[e.targetObj]=t.value,t.parentNode.parentNode.querySelector(".selected").classList.remove("selected"),t.parentNode.classList.add("selected"),this.selected=s,e.callback&&e.callback()}}}class k{constructor(){let e=new O({cssClass:"horizontal-menu full-width small-legends",options:[{title:"Today",value:"today",selected:!0,legend:a.totalAscentCount.today,val:"totalAscentCount.today"},{title:"30 days",value:"thirtydays",legend:a.totalAscentCount.thirtydays,val:"totalAscentCount.thirtydays"},{title:"Year",value:"year",legend:a.totalAscentCount.year,val:"totalAscentCount.year"},{title:"All time",value:"alltime",legend:a.totalAscentCount.alltime,val:"totalAscentCount.alltime"}],targetObj:"scope"}),t=p({el:"SECTION",cssClass:"progression"});t.appendChild(e.render());p({el:"DIV"});let s=p({el:"DIV",cssClass:"important-numbers"}),l=p({el:"DIV",cssClass:"important-points"}),o=p({el:"H3",content:"Points"}),n=p({el:"H2",content:a.totalScore.toString()});l.append(o,n),a.storeObservers.push({key:"totalScore",callback:()=>{n.innerHTML=a.totalScore}});let r=p({el:"DIV",cssClass:"important-ascents"}),c=p({el:"H3",content:"Ascents"}),i=p({el:"H2",content:a.totalAscentCount[a.scope]});r.append(c,i),a.storeObservers.push({key:"scope",callback:()=>{i.innerHTML=a.totalAscentCount[a.scope]}}),a.storeObservers.push({key:"ticks",callback:()=>{i.innerHTML=a.totalAscentCount[a.scope]}});let d=p({el:"DIV",cssClass:"important-grade"}),y=p({el:"H3",content:"Avg. grade"}),C=p({el:"H2",content:a.averageGrade});d.append(y,C),a.storeObservers.push({key:"averageGrade",callback:()=>{C.innerHTML=a.averageGrade}}),a.storeObservers.push({key:"scope",callback:()=>{C.innerHTML=a.averageGrade}}),s.append(l,r,d),t.appendChild(s);let m=document.createElement("SPAN");m.className="graph-pulldown";let f=p({el:"DIV",cssClass:"stripes"});f.append(p({el:"DIV"}),p({el:"DIV"}),p({el:"DIV"})),m.appendChild(f),t.appendChild(m);let k=p({el:"DIV",cssClass:"grade-distribution hidden"}),A=p({el:"H3",content:"Grade distribution"}),S=p({el:"DIV",cssClass:"grade-chart"}),T=p({el:"DIV",cssClass:"chart-container"}),I=document.createDocumentFragment();for(let e=0,t=a.grades.font.length;e<t;e++){let e=p({el:"DIV"}),t=p({el:"SPAN",cssClass:"bar"});e.appendChild(t),I.appendChild(e)}m.addEventListener("click",()=>{k.classList.toggle("hidden")},!1),T.appendChild(I),S.appendChild(T),k.append(A,S);let N=p({el:"DIV",cssClass:"chart-legend"}),L=document.createDocumentFragment();for(let e=0,t=a.grades.font.length;e<t;e++){let t=p({el:"DIV",content:a.grades.font[e]});L.appendChild(t)}N.appendChild(L),k.appendChild(N);let w=()=>{a.totalAscentCount[a.scope]=b(a.scope).total,a.currentScore=h(),a.totalScore=u(),a.averageGrade=g(5);let e=T.querySelectorAll(".bar"),t=v({scope:a.scope});e.forEach((e,s)=>{e.style.height="".concat(t[s],"px")})};t.appendChild(k),a.storeObservers.push({key:"indoorsOutdoors",callback:w}),a.storeObservers.push({key:"scope",callback:w}),a.storeObservers.push({key:"ticks",callback:w}),w(),this.render=()=>t}}class A{constructor(e){this.selected=!1;let t=p({el:"DIV",cssClass:"grade-dial-container"}),s=p({el:"DIV",cssClass:"select-dialog-viewport"}),l=p({el:"DIV",cssClass:"select-dialog",attrbs:[["data-enablescroll","true"]]});s.addEventListener("scroll",e=>{l.firstChild.getBoundingClientRect().height;let t=Math.floor(s.scrollTop/(l.scrollHeight-200)*a.grades.font.length);t!==a.currentAscentGrade&&(a.currentAscentGrade=t,(e=>{let t="vibrate"in navigator,s=[10,0];e&&e.duration&&(s=e.duration),t&&window.navigator.vibrate(s)})())},!1);let o=document.createDocumentFragment(),n=C();for(let e=0,t=a.grades.font.length;e<t;e++){let t=p({el:"DIV"}),s=p({el:"SPAN",content:a.grades.font[e]}),l=p({el:"SPAN",cssClass:"legends-holder"});Object.keys(n).forEach(t=>{let s=p({el:"SPAN",cssClass:"legend type-".concat(t),content:n[t][e]});l.appendChild(s)}),s.appendChild(l),t.appendChild(s),o.appendChild(t)}let r=()=>{let e=C();Object.keys(e).forEach(t=>{for(let s in e[t])if(l.childNodes[s].querySelector(".legends-holder .type-".concat(t)))l.childNodes[s].querySelector(".legends-holder .type-".concat(t)).innerHTML=e[t][s]?e[t][s]:"";else{let o=p({el:"SPAN",cssClass:"legend type-".concat(t),content:e[t][s]});l.childNodes[s].querySelector(".legends-holder").appendChild(o)}})};a.storeObservers.push({key:"indoorsOutdoors",callback:()=>{l.querySelectorAll(".legends-holder .legend").forEach((e,t)=>{e.parentNode.removeChild(e)}),r()}}),a.storeObservers.push({key:"ticks",callback:r}),l.appendChild(o),s.appendChild(l);let c=p({el:"DIV",cssClass:"bullet"});t.appendChild(c),t.appendChild(s);let i=new MutationObserver((function(e){document.contains(s)&&(setTimeout(()=>{let e=l.firstChild.getBoundingClientRect().height;s.scrollTo(0,e*a.currentAscentGrade+50)},300),i.disconnect())}));i.observe(document,{attributes:!1,childList:!0,characterData:!1,subtree:!0}),this.render=()=>t,this.get=()=>this.selectd}}const S={get:(e,t)=>e[t],set:(e,t,s)=>{e[t]=s,console.log("setting property ".concat(t," : ").concat(e[t]));for(let s=0,l=N.storeObservers.length;s<l;s++)N[N.storeObservers[s].key]===e[t]&&N.storeObservers[s].callback();return!0}};let T=s({key:"user"}),I={storeObservers:[],name:{firstName:T.name?T.name:null,lastName:T.lastName?T.lastName:null,userName:T.userName?T.userName:null,email:T.email?T.email:null,id:T.id?T.id:null},login:{isLoggedIn:T.isLoggedIn?T.isLoggedIn:null},ticks:[...a.ticks]};const N=new Proxy(I,S);class L{constructor(){let e=new A,l=new O({cssClass:"horizontal-menu full-width",id:"ascent-type-selector",targetObj:"currentAscentType",options:[{title:"Redpoint",value:"redpoint",selected:!0,legend:a.totalAscents.redpoint,val:"totalAscents.redpoint"},{title:"Flash",value:"flash",legend:a.totalAscents.flash,val:"totalAscents.flash"},{title:"Onsight",value:"onsight",legend:a.totalAscents.onsight,val:"totalAscents.onsight"}]}),o=p({el:"SECTION",cssClass:"grade bgr-gradient"}),n=p({el:"DIV",cssClass:"grade-selector"});n.appendChild(e.render()),n.appendChild(l.render());let r=p({el:"DIV",cssClass:"tick-buttons-container"}),c=p({el:"A",cssClass:"btn btn_white",content:"Remove Tick"}),i=p({el:"DIV",cssStyle:"width: 20px; min-width: 20px;"}),d=p({el:"A",cssClass:"btn type-redpoint",content:"Tick"}),u=e=>{if(a.currentAscentGrade<0)return;let l=a.currentAscentGrade,o=a.currentAscentType,n=N.ticks;if(console.log(N),console.log(n),e)n.push({type:a.currentClimbingType,indoorsOutdoors:a.indoorsOutdoors,grade:l,ascentType:o,date:(new Date).getTime(),uuid:([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)),location:!1,synchronized:!1});else{let e=[];for(let t=0,s=n.length;t<s;t++){let s=a.today.split("-");s=new Date(s[0],s[1],s[2]).getTime(),n[t].date>=s&&n[t].grade===l&&n[t].ascentType===o&&n[t].indoorsOutdoors===a.indoorsOutdoors&&n[t].type===a.currentClimbingType&&e.push(t)}e.length&&n.splice(e[e.length-1],1)}let r=s({key:"user"});console.log(r),r.ticks=n,t({key:"user",keydata:r}),a.ticks=n};d.addEventListener("click",()=>{u(!0)},!1),c.addEventListener("click",()=>{u(!1)},!1),r.append(c,i,d),n.appendChild(r);let g=p({el:"DIV",cssClass:"navi-shadow"});o.append(n,g),this.render=()=>o}}class w{constructor(){let e=new k,t=new L,s=p({el:"DIV",cssClass:"page-tick"}),l=p({el:"DIV",cssClass:"in-out-selector"}),o=p({el:"DIV",cssClass:"current"}),n=()=>"boulder"===a.currentClimbingType?"Bouldering ".concat(a.indoorsOutdoors):"sport"===a.currentClimbingType?"Climbing sport ".concat(a.indoorsOutdoors):"trad"===a.currentClimbingType?"Climbing trad ".concat(a.indoorsOutdoors):"toprope"===a.currentClimbingType?"Top roping ".concat(a.indoorsOutdoors):a.indoorsOutdoors,r=p({el:"H3",content:n()});o.appendChild(r),a.storeObservers.push({key:"currentClimbingType",id:"homepageCurrentClimbingType",callback:()=>{r.innerHTML=n()}}),a.storeObservers.push({key:"indoorsOutdoors",id:"homepageIndoorsOutdoors",callback:()=>{r.innerHTML=n()}}),l.appendChild(o),s.appendChild(l),s.appendChild(e.render()),s.appendChild(t.render()),this.render=()=>s}}function P(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,l)}return s}function D(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?P(Object(s),!0).forEach((function(t){x(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):P(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function x(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class j{constructor(){let e=p({el:"DIV",cssClass:"login-page"}),s=p({el:"SECTION",cssClass:"login-form"}),l=p({el:"DIV",cssClass:"logo-container"}),o=p({el:"IMG",source:"/images/napak_vector.svg",cssClass:"logo"}),n=p({el:"SPAN",content:"  0.x"});l.append(o,n);let r=p({el:"INPUT",attrbs:[["placeholder","User name"]]}),a=p({el:"INPUT",attrbs:[["placeholder","Password"],["type","password"]]}),c=p({el:"A",cssClass:"btn mt mb",content:"Login"});c.addEventListener("click",()=>{N.login.isLoggedIn=!0,N.name.userName=r.value,N.login=N.login,t({key:"user",keydata:D({},N.name,{},N.login)})},!1),s.append(l,r,a,c),e.append(s),this.render=()=>e}}class E{constructor(){let t=a.ticks,s=p({el:"SECTION",cssClass:"page-tick"}),l=p({el:"H3",content:"Ticks archive"}),o=p({el:"DIV",cssClass:"today tick-list"}),n=p({el:"TABLE"});t.sort((function(e,t){var s=e.date,l=t.date;return s<l?-1:s>l?1:0}));let r="0000-00-00";for(let s=t.length-1,l=0;s>=l;s--){let l=e({dateString:t[s].date});if(l!==r){let t=p({el:"TR",cssClass:"header"}),s=p({el:"TH",content:e({dateString:l,dateFormat:"yyyy-mm-dd"}),attrbs:[["colspan",4]]});t.appendChild(s),n.appendChild(t),r=l}let o=p({el:"TR"}),c=p({el:"TD",content:t[s].indoorsOutdoors}),i=p({el:"TD",content:t[s].type}),d=p({el:"TD"}),u=p({el:"SPAN",cssClass:"grade-legend",content:a.grades.font[t[s].grade]});d.appendChild(u);let g=p({el:"TD",content:t[s].ascentType});o.append(d,g,i,c),n.appendChild(o)}o.appendChild(n),s.append(l,o),this.render=()=>s}}class V{constructor(e){let t=p({el:"DIV"}),s=e.chartHeight?e.chartHeight:320;this.pixelRatio=window.devicePixelRatio?window.devicePixelRatio:1;let l=p({el:"CANVAS",attrbs:[["width",320*this.pixelRatio],["height",this.pixelRatio*s]],cssStyle:"width: 320px; height: ".concat(s,"px;")});this.ctx=l.getContext("2d"),l.xCenter=160,l.yCenter=s/2,this.ctx.scale(this.pixelRatio,this.pixelRatio),this.canvas=l,this.pie=()=>{let l=0,o=0;const n=e.data.reduce((e,t)=>e+t,0);this.ctx.clearRect(0,0,320,s),this.ctx.beginPath();let r=s/10,a=s/2-r/2;o=25;for(let t=0,s=e.data.length;t<s;t++){l=100/n*e.data[t];let s=(2-.02*o)*Math.PI,c=(2-.02*(o+l))*Math.PI,i=!0;this.ctx.beginPath(),this.ctx.arc(this.canvas.xCenter,this.canvas.yCenter,a,s,c,i),this.ctx.lineWidth=r,this.ctx.strokeStyle=e.colors[t],this.ctx.stroke(),o+=l}this.ctx.closePath();let c=p({el:"UL",cssStyle:"display: flex; justify-content: space-between"});for(let t=0,s=e.labels.length;t<s;t++){let s=p({el:"LI",content:e.labels[t],cssStyle:"color : ".concat(e.colors[t],"; position: relative")}),l=p({el:"SPAN",cssClass:"legends-holder"}),o=p({el:"SPAN",cssClass:"legend type-".concat(e.labels[t].toLowerCase()),content:e.data[t]});l.appendChild(o),s.appendChild(l),c.appendChild(s)}t.append(this.canvas,c)},this.barchart=()=>{this.ctx.clearRect(0,0,320,180),this.ctx.beginPath();let s=10/e.data.length,l=s/2,o=Math.max(...e.data.flat(1/0)),n=10*Math.ceil(o/10);this.ctx.lineCap="round";let r=160/(n/10),a=160/r;this.ctx.setLineDash([5,15]),this.ctx.strokeStyle="rgba(255,255,255,.8)";for(let e=0,t=a+1;e<t;e++)this.ctx.beginPath(),this.ctx.moveTo(20,r*e),this.ctx.lineTo(300,r*e),e===t-1&&this.ctx.setLineDash([]),this.ctx.stroke();this.ctx.fillStyle=e.color?e.colors[h]:"rgba(255,255,255,.8)",this.ctx.font="6.5px IBM Plex Mono",this.ctx.lineWidth=1;for(let e=0,t=a+1;e<t;e++)this.ctx.fillText(n-10*e,0,r*e+6.5,20);for(let t=0,o=e.data.length;t<o;t++)for(let o=0,r=e.data[t].length;o<r;o++)this.ctx.beginPath(),this.ctx.moveTo(20+t*(s+3)+300*o/e.data[t].length+s/2,160-l),this.ctx.lineTo(20+t*(s+3)+300*o/e.data[t].length+s/2,160-(160/n*e.data[t][o]-l)),this.ctx.lineWidth=s,this.ctx.strokeStyle=e.colors?e.colors[t]:getComputedStyle(document.documentElement).getPropertyValue("--color-flash"),e.data[t][o]&&this.ctx.stroke();this.ctx.closePath(),this.ctx.fillStyle=e.color?e.colors[h]:"rgba(255,255,255,.8)",this.ctx.font="6.5px IBM Plex Mono",this.ctx.lineWidth=1;for(let t=0,s=e.xaxis.length;t<s;t++)this.ctx.fillText(e.xaxis[t],20+300*t/e.xaxis.length,180);t.append(this.canvas)},"pie"===e.type&&this.pie(),"barchart"===e.type&&this.barchart(),this.render=()=>t}}class M{constructor(){let e=b("alltime"),t=p({el:"SECTION",cssClass:"page-statistics"}),s=p({el:"DIV",cssClass:"page-title-container"}),l=p({el:"H3",content:"Ascents by type"});s.appendChild(l);let o={type:"pie",labels:["Redpoint","Flash","Onsight"],data:[e.redpoint,e.flash,e.onsight],colors:[getComputedStyle(document.documentElement).getPropertyValue("--color-redpoint"),getComputedStyle(document.documentElement).getPropertyValue("--color-flash"),getComputedStyle(document.documentElement).getPropertyValue("--color-onsight")],chartHeight:180},n=p({el:"H3",content:"Ascents by grade"}),r=new V(o),c=v({scope:"alltime",indoorsOutdoors:"indoors"}),i=v({scope:"alltime",indoorsOutdoors:"outdoors"}),d={type:"barchart",xaxis:a.grades.font,data:[c,i],chartHeight:180,colors:["#0f8","#08F"]},u=new V(d),g=p({el:"DIV",cssClass:"navi-shadow"});t.append(s,r.render(),n,u.render(),g),this.render=()=>t}}class H{constructor(e){let t=p({el:"DIV",cssClass:"on-off-selector"}),s=p({el:"SPAN",content:e.options[0].title}),l=p({el:"SPAN",content:e.options[1].title}),o=p({el:"DIV",cssClass:"on-off-switch"}),n=!e.options[0].selected;n&&o.classList.add("switched-off");let r=()=>{n=!n,o.classList.toggle("switched-off"),a[e.targetObj]=n?e.options[1].value:e.options[0].value};o.addEventListener("click",r,!1),s.addEventListener("click",r,!1),l.addEventListener("click",r,!1),t.append(s,o,l),this.render=()=>t}}class G{constructor(){let e=p({el:"SECTION",cssClass:"page-settings"}),t=p({el:"DIV",cssClass:"logo-container"}),s=p({el:"IMG",source:"/images/napak_vector.svg",cssClass:"logo"}),l=p({el:"SPAN",content:" 0.x"});t.append(s,l),N.storeObservers.push({key:"ticks",id:"appTicks",callback:updateAll});let o=p({el:"DIV",cssClass:"login-info"});if(N.login.isLoggedIn){let e=p({el:"H3",cssClass:"mt mb",content:"Logged in as ".concat(N.name.userName," 😻")}),t=p({el:"A",cssClass:"btn login-ling",content:"Logout"});o.append(e,t),t.addEventListener("click",()=>{N.login.isLoggedIn=!1,N.login=N.login},!1)}else{let e=p({el:"H3",cssClass:"mt mb",content:"Not logged in. No data is saved"}),t=p({el:"A",cssClass:"btn login-ling",content:"Login"});o.append(e,t)}let n=p({el:"DIV",cssClass:"settings"}),r=p({el:"H3",content:"VIBRATE WHEN TICKING"}),a=new H({cssClass:"horizontal-menu full-width",targetObj:"vibrate",options:[{title:"On",value:"on"},{title:"Off",value:"off"}]}),c=p({el:"H3",content:"LOCATION TRACKING"}),i=new H({cssClass:"horizontal-menu full-width",targetObj:"vibrate",options:[{title:"On",value:"on"},{title:"Off",value:"off"}]});n.append(r,a.render(),c,i.render());let d=p({el:"DIV",cssClass:"navi-shadow"});e.append(t,o,n,d),this.render=()=>e}}class B{constructor(e){this.targetObj=e.targetObj;let t=p({el:"DIV",cssClass:"dropdown-container"}),s=p({el:"DIV",cssClass:"dropdown-selected"}),l=p({el:"SPAN",content:"-"});s.appendChild(l);let o=p({el:"DIV",cssClass:"dropdown-options hidden"});e.options.forEach(t=>{let s=p({el:"A",content:t.title});t.selected&&(s.classList.add("selected"),this.selected=t,a[e.targetObj]=t.value,l.innerHTML=t.title),o.appendChild(s),s.addEventListener("click",()=>{this.set(s,t)},!1)}),s.appendChild(o),t.appendChild(s),this.render=()=>t,s.addEventListener("click",()=>{this.toggle()},!1),this.toggle=()=>{o.classList.toggle("hidden")},this.set=(t,s)=>{t.parentNode.querySelectorAll(".selected").forEach(e=>{e.classList.remove("selected")}),t.classList.add("selected"),a[e.targetObj]=s.value,l.innerHTML=s.title}}}class R{constructor(){let e=p({el:"DIV",cssClass:"groups-page"}),t=p({el:"SECTION",cssClass:"group-select"}),s=new O({cssClass:"horizontal-menu centerize",id:"ascent-type-selector",targetObj:"groupType",options:[{title:"Your groups",value:"userGroups",selected:!0,val:"totalAscents.redpoint"},{title:"Public groups",value:"publicGroups",val:"totalAscents.flash"}]}),l=new B({cssClass:"horizontal-menu full-width",id:"ascent-type-selector",targetObj:"currentGroup",options:[{title:"🍆 Sendipallit",value:"sendipallit",selected:!0},{title:"🍑 bk climbers",value:"bkclimbers"},{title:"🥑 Top ropers",value:"topropers"}]});t.append(s.render(),l.render());let o=p({el:"SECTION",cssClass:"ranking"}),n=new O({cssClass:"horizontal-menu full-width",id:"ascent-type-selector",targetObj:"currentAscentType",options:[{title:"Boulder",value:"boulder",selected:!0},{title:"Sport",value:"sport"},{title:"Top rope",value:"toprope"},{title:"Trad",value:"trad"}]}),r=p({el:"UL",cssClass:"group-toplist"});for(let e=0,t=10;e<t;e++){let t=p({el:"LI",cssClass:"entry-container"}),s=p({el:"SPAN",content:"".concat(e+1,".")}),l=p({el:"SPAN",content:"Pyry"}),o=p({el:"SPAN",content:7500}),n=p({el:"SPAN",cssClass:"dir",content:["↓","↑","-"][~~(3*Math.random())]});o.appendChild(n);let a=p({el:"SPAN",content:"7A"});t.append(s,l,o,a),r.append(t,t)}o.append(n.render(),r);let a=p({el:"a",cssClass:"btn mt mb"}),c=p({el:"IMG",source:"/images/icon_plus.svg"}),i=document.createTextNode("Create new group");a.append(c,i),o.append(a),e.append(t,o),this.render=()=>e}}class q{constructor(e){this.targetObj=e.targetObj,this.legends=[];let t=e.cssClass?e.cssClass:"",s=p({el:"DIV",cssClass:"footer-pullup-menu hidden small-legends ".concat(t)});e.options.forEach(t=>{let l=p({el:"SPAN"});t.selected&&(l.classList.add("selected"),this.selected=t,a[e.targetObj]=t.value);let o=p({el:"SPAN",cssClass:"menu-title",content:t.title}),n=p({el:"SPAN",cssClass:"legends-holder"}),r=p({el:"SPAN",cssClass:"legend type-".concat(t.value),content:t.val?t.val:""});if(r.value=t.val,this.legends.push(r),n.appendChild(r),o.appendChild(n),t.icon){l.classList.add("icons");let e=p({el:"IMG",source:t.icon,attrbs:[["label",o],["title","nih"]]});l.append(e,o)}else l.appendChild(o);l.addEventListener("click",()=>{this.set(l,t.value)},!1),s.appendChild(l)});let l=()=>{this.legends.forEach(e=>{let t=e.value;if(t){let s=t.split(".").reduce((e,t)=>e[t],a);e.innerHTML=s||""}})};a.storeObservers.push({key:"indoorsOutdoors",callback:l}),a.storeObservers.push({key:"ticks",callback:l}),a.storeObservers.push({key:"totalAscentsByType",callback:l}),this.render=()=>s,this.close=()=>{s.classList.add("hidden")},this.toggle=()=>{for(let e=0,t=a.openMenus.length;e<t;e++)a.openMenus[e]!==this&&a.openMenus[e].close();a.openMenus=[],s.classList.toggle("hidden"),s.classList.contains("hidden")?document.body.classList.remove("footer-pulldown"):(a.openMenus.push(this),document.body.classList.add("footer-pulldown"))},this.set=(t,l)=>{if(e.linksOnly)return void(e.callback&&e.callback(l));a[e.targetObj]=l;let o=s.querySelector(".selected");o&&o.classList.remove("selected"),t.classList.add("selected"),e.callback&&e.callback(l)}}}let z=e=>{let t=new a.routes[e];document.querySelector(".page-content").innerHTML="",document.querySelector(".page-content").appendChild(t.render())};class F{constructor(e){let t=p({el:"FOOTER",cssClass:"hidden"}),s=p({el:"NAV"}),l=p({el:"a"}),o=p({el:"SPAN"}),n=p({el:"IMG",source:"images/rock.svg"}),r=p({el:"SPAN",content:a.currentClimbingType});o.append(n,r),l.append(o);let c=function(){(()=>{a.currentScore=h(),a.totalScore=u(),a.totalAscentCount.today=b("today").total,a.totalAscentCount.thirtydays=b("thirtydays").total,a.totalAscentCount.year=b("year").total,a.totalAscentCount.alltime=b("alltime").total,a.totalAscents=b("today");let e=a.ticks;a.ticks=e,a.totalAscentsByType=m(),a.averageGrade=g(5)})(),r.innerHTML=a.currentClimbingType},i=new q({options:[{title:"Boulder",value:"boulder",selected:!0,legend:a.totalAscentsByType.boulder,val:"totalAscentsByType.boulder"},{title:"Sport",value:"sport",legend:a.totalAscentsByType.sport,val:"totalAscentsByType.sport"},{title:"Top rope",value:"toprope",legend:a.totalAscentsByType.toprope,val:"totalAscentsByType.toprope"},{title:"Trad",value:"trad",legend:a.totalAscentsByType.trad,val:"totalAscentsByType.trad"}],targetObj:"currentClimbingType",listen:"ticks",callback:c});l.appendChild(i.render()),l.addEventListener("click",()=>{i.toggle()},!1);let d=p({el:"a",attrbs:[["label","indoors or outdoors"]]}),y=p({el:"SPAN"}),C=p({el:"IMG",source:"images/garden.svg"}),v=p({el:"SPAN",content:a.indoorsOutdoors});y.append(C,v),d.append(y);let f=new q({options:[{title:"Outdoors",value:"outdoors",selected:"outdoors"===a.indoorsOutdoors},{title:"Indoors",value:"indoors",selected:"indoors"===a.indoorsOutdoors}],targetObj:"indoorsOutdoors",callback:c});d.appendChild(f.render()),d.addEventListener("click",()=>{f.toggle(),v.innerHTML=a.indoorsOutdoors},!1);let O=p({el:"DIV",cssClass:"logo-container"}),k=p({el:"IMG",source:"/images/napak_vector.svg",cssClass:"logo"});O.appendChild(k),O.addEventListener("click",()=>{z("home")},!1);let A=p({el:"a",attrbs:[["label","statistics"]]}),S=p({el:"SPAN"}),T=p({el:"IMG",source:"images/stats.svg"}),I=p({el:"SPAN",content:"statistics"});S.append(T,I),A.append(S),A.addEventListener("click",()=>{z("statistics")},!1);let L=p({el:"a",attrbs:[["label","more options"]]}),w=p({el:"SPAN"}),P=p({el:"IMG",source:"images/more.svg"}),D=p({el:"SPAN",content:"More"});w.append(P,D),L.append(w);let x=new q({options:[{title:"Settings",value:"settings",icon:"/images/rock.svg"},{title:"History",value:"history",icon:"/images/rock.svg"},{title:"Groups",value:"groups",icon:"/images/rock.svg"}],cssClass:"right links-only",callback:function(e){z(e)},linksOnly:!0});L.appendChild(x.render()),L.addEventListener("click",()=>{document.body.classList.toggle("otc")},!1),s.append(l,d,O,A,L),t.appendChild(s);let j=()=>{N.login.isLoggedIn?t.classList.remove("hidden"):t.classList.add("hidden")};N.storeObservers.push({key:"login",callback:j}),j(),this.render=()=>t}}function U(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,l)}return s}function W(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?U(Object(s),!0).forEach((function(t){_(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):U(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function _(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class K{constructor(){let e=p({el:"DIV",cssClass:"otc-navigation"}),s=p({el:"NAV"});s.addEventListener("click",()=>{document.body.classList.toggle("otc")},!1);let l=p({el:"DIV",cssClass:"otc-links-container"}),o=p({el:"DIV",cssClass:"logo-container"}),n=p({el:"IMG",source:"/images/napak_vector.svg",cssClass:"logo"}),r=p({el:"SPAN",content:" 0.x"});o.append(n,r);let a=p({el:"DIV",cssClass:"login-info"}),c=p({el:"H3",cssClass:"mt mb username",content:"Logged in as ".concat(N.name.userName," 😻")}),i=p({el:"A",cssClass:"btn login-link",content:"Logout"});a.append(c,i),i.addEventListener("click",()=>{N.login.isLoggedIn=!1,N.login=N.login,t({key:"user",keydata:W({},N.name,{},N.login)}),document.body.classList.remove("otc")},!1);N.storeObservers.push({key:"login",callback:()=>{a.querySelector("H3.username").innerHTML="Logged in as ".concat(N.name.userName," 😻")}});let d=p({el:"DIV",cssClass:"settings"}),u=p({el:"H3",content:"VIBRATE WHEN TICKING"}),g=new H({cssClass:"horizontal-menu full-width",targetObj:"vibrate",options:[{title:"On",value:"on"},{title:"Off",value:"off"}]}),h=p({el:"H3",content:"LOCATION TRACKING"}),y=new H({cssClass:"horizontal-menu full-width",targetObj:"vibrate",options:[{title:"On",value:"on"},{title:"Off",value:"off"}]});d.append(u,g.render(),h,y.render());let b=p({el:"SECTION",cssClass:"sidenav-links"}),C=p({el:"A",content:"Groups"}),m=p({el:"A",content:"History"});C.addEventListener("click",()=>{z("groups"),document.body.classList.remove("otc")},!1),m.addEventListener("click",()=>{z("history"),document.body.classList.remove("otc")},!1),b.append(C,m),l.append(o,a,d,b),e.append(l,s),this.render=()=>e}}(()=>{a.routes.home=w,a.routes.history=E,a.routes.statistics=M,a.routes.settings=G,a.routes.groups=R,a.routes.login=j;let e=p({el:"DIV",cssClass:"app"}),t=p({el:"DIV",cssClass:"page-content"}),s=new F,l=new K,o=()=>{a.currentScore=h(),a.totalScore=u(),a.averageGrade=g(5),a.totalAscentsByType=m(),a.totalAscents=b("today"),a.totalAscentCount.today=b("today").total,a.totalAscentCount.thirtydays=b("thirtydays").total,a.totalAscentCount.year=b("year").total,a.totalAscentCount.alltime=b("alltime").total};o(),a.storeObservers.push({key:"ticks",id:"appTicks",callback:o}),a.storeObservers.push({key:"indoorsOutdoors",id:"appIndoorsOutdoors",callback:o}),document.body.innerHTML="",e.append(t,s.render(e),l.render());let n=p({el:"DIV",cssClass:"navi-shadow"});e.append(n),document.body.appendChild(e);let r=()=>{N.login.isLoggedIn?z("home"):z("login")};N.storeObservers.push({key:"login",callback:r}),r()})();